discord_webhook_url = ENV['DISCORD_WEBHOOK_URL']

desc 'Сборка тестов'
lane :build_for_testing do
    cocoapods
    scan(
      derived_data_path: "DerivedData",
      build_for_testing: true
    )
end

desc 'Запуск тестов'
lane :run_test_without_build do
    scan(
      derived_data_path: "DerivedData",
      test_without_building: true
    )
end

desc 'Запуск тестов'
lane :build_and_test do
  build_for_testing
  run_test_without_build
  discord
end

desc 'Уведомление в Discord'
lane :discord do
  discord_notifier(
    webhook_url: discord_webhook_url,
    title: "chatterbox",
    description: "Build has been finished"
  )
end
